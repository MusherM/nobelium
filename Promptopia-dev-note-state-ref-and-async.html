<!DOCTYPE html><html lang="zh-CN"><head><meta name="viewport" content="width=device-width"/><title>Promptopia å¼€å‘ç¬”è®°ï¼ˆ2ï¼‰â€”â€”useStateã€useRefä¸å¼‚æ­¥é€»è¾‘</title><meta name="robots" content="follow, index"/><meta charSet="UTF-8"/><meta name="keywords" content="Blog, Notion, Tech, React, Vue"/><meta name="description" content="ä»ä¸€æ¬¡ debug ç»å†å‡ºå‘ï¼Œè®²è®² JS é‡Œçš„å¼‚æ­¥æœºåˆ¶å¦‚ä½•å½±å“ä½ çš„ä»£ç æ‰§è¡Œï¼Ÿ"/><meta property="og:locale" content="zh-CN"/><meta property="og:title" content="Promptopia å¼€å‘ç¬”è®°ï¼ˆ2ï¼‰â€”â€”useStateã€useRefä¸å¼‚æ­¥é€»è¾‘"/><meta property="og:description" content="ä»ä¸€æ¬¡ debug ç»å†å‡ºå‘ï¼Œè®²è®² JS é‡Œçš„å¼‚æ­¥æœºåˆ¶å¦‚ä½•å½±å“ä½ çš„ä»£ç æ‰§è¡Œï¼Ÿ"/><meta property="og:url" content=""/><meta property="og:image" content="https://og-image-craigary.vercel.app/Promptopia%20%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0%EF%BC%882%EF%BC%89%E2%80%94%E2%80%94useState%E3%80%81useRef%E4%B8%8E%E5%BC%82%E6%AD%A5%E9%80%BB%E8%BE%91.png?theme=dark&amp;md=1&amp;fontSize=125px&amp;images=https%3A%2F%2Fnobelium.vercel.app%2Flogo-for-dark-bg.svg"/><meta property="og:type" content="article"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:description" content="ä»ä¸€æ¬¡ debug ç»å†å‡ºå‘ï¼Œè®²è®² JS é‡Œçš„å¼‚æ­¥æœºåˆ¶å¦‚ä½•å½±å“ä½ çš„ä»£ç æ‰§è¡Œï¼Ÿ"/><meta name="twitter:title" content="Promptopia å¼€å‘ç¬”è®°ï¼ˆ2ï¼‰â€”â€”useStateã€useRefä¸å¼‚æ­¥é€»è¾‘"/><meta name="twitter:image" content="https://og-image-craigary.vercel.app/Promptopia%20%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0%EF%BC%882%EF%BC%89%E2%80%94%E2%80%94useState%E3%80%81useRef%E4%B8%8E%E5%BC%82%E6%AD%A5%E9%80%BB%E8%BE%91.png?theme=dark&amp;md=1&amp;fontSize=125px&amp;images=https%3A%2F%2Fnobelium.vercel.app%2Flogo-for-dark-bg.svg"/><meta property="article:published_time"/><meta property="article:author" content="Musher"/><meta name="next-head-count" content="18"/><link rel="preload" href="/nobelium/fonts/IBMPlexSansVar-Roman.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/nobelium/fonts/IBMPlexSansVar-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="preload" as="style" data-href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&amp;display=swap"/><link rel="stylesheet" data-href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&amp;display=swap"/><noscript><link rel="stylesheet" data-href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&amp;display=swap"/></noscript><link rel="icon" href="/nobelium/favicon.svg" type="image/svg+xml"/><link rel="icon" href="/nobelium/favicon.ico"/><link rel="apple-touch-icon" sizes="192x192" href="/nobelium/apple-touch-icon.png"/><link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/nobelium/feed"/><meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)"/><meta name="theme-color" content="#18181B" media="(prefers-color-scheme: dark)"/><link rel="preload" href="/nobelium/_next/static/css/ddbbae80d81b2f88.css" as="style"/><link rel="stylesheet" href="/nobelium/_next/static/css/ddbbae80d81b2f88.css" data-n-g=""/><link rel="preload" href="/nobelium/_next/static/css/6a5815369e10547f.css" as="style"/><link rel="stylesheet" href="/nobelium/_next/static/css/6a5815369e10547f.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/nobelium/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/nobelium/_next/static/chunks/webpack-017be00eb10a1ae1.js" defer=""></script><script src="/nobelium/_next/static/chunks/main-5b58b7da4815128c.js" defer=""></script><script src="/nobelium/_next/static/chunks/pages/_app-b95f08d6067917bb.js" defer=""></script><script src="/nobelium/_next/static/chunks/b5f2ed29-08db60af0c3043ba.js" defer=""></script><script src="/nobelium/_next/static/chunks/684-63c1a25e215d8bed.js" defer=""></script><script src="/nobelium/_next/static/chunks/580-c0214944b9e37cce.js" defer=""></script><script src="/nobelium/_next/static/chunks/pages/%5Bslug%5D-e6f3f3c220b132e2.js" defer=""></script><script src="/nobelium/_next/static/pLVj_ZB4irF9cq-SHm4_w/_buildManifest.js" defer=""></script><script src="/nobelium/_next/static/pLVj_ZB4irF9cq-SHm4_w/_ssgManifest.js" defer=""></script><script src="/nobelium/_next/static/pLVj_ZB4irF9cq-SHm4_w/_middlewareManifest.js" defer=""></script><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap"/></head><body class="bg-day dark:bg-night"><div id="__next" data-reactroot=""><div><div class="wrapper font-sans"><div class="observer-element h-4 md:h-12"></div><div class="sticky-nav m-auto w-full h-6 flex flex-row justify-between items-center mb-2 md:mb-12 py-8 bg-opacity-60 max-w-3xl px-4" id="sticky-nav"><div class="flex items-center"><a aria-label="Musher&#x27;s Frontend Coding Blog" href="/nobelium"><div class="h-6"><svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="14" cy="14" r="14" class="fill-current text-black dark:text-white"></circle><circle cx="14" cy="14" r="14" fill="url(#paint0_radial)"></circle><circle cx="8" cy="8" r="2" fill="white"></circle><defs><radialGradient id="paint0_radial" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="rotate(45) scale(39.598)"><stop stop-color="#7FF72A" stop-opacity="1"></stop><stop offset="1" stop-color="#001FCC" stop-opacity="0.1"></stop></radialGradient></defs></svg></div></a><p class="ml-2 font-medium text-day dark:text-night header-name">Promptopia å¼€å‘ç¬”è®°ï¼ˆ2ï¼‰â€”â€”useStateã€useRefä¸å¼‚æ­¥é€»è¾‘</p></div><div class="flex-shrink-0"><ul class="flex flex-row"><li class="block ml-4 text-black dark:text-gray-50 nav"><a href="/nobelium/search">æœç´¢</a></li></ul></div></div><main class="m-auto flex-grow w-full transition-all max-w-3xl px-4"><article><h1 class="font-bold text-3xl text-black dark:text-white">ğŸ§‘â€ğŸ’»<!-- --> <!-- -->Promptopia å¼€å‘ç¬”è®°ï¼ˆ2ï¼‰â€”â€”useStateã€useRefä¸å¼‚æ­¥é€»è¾‘</h1><nav class="flex mt-7 items-start text-gray-500 dark:text-gray-400"><div class="flex mb-4"><a href="#" class="flex"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2724%27%20height=%2724%27/%3e"/></span><img alt="Musher" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="Musher" srcSet="https://gravatar.com/avatar/568c024e516219d57a6ef037a7cc3d32?imwidth=32 1x, https://gravatar.com/avatar/568c024e516219d57a6ef037a7cc3d32?imwidth=48 2x" src="https://gravatar.com/avatar/568c024e516219d57a6ef037a7cc3d32?imwidth=48" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="rounded-full" loading="lazy"/></noscript></span><p class="ml-2 md:block">Musher</p></a><span class="block">Â /Â </span></div><div class="mr-2 mb-4 md:ml-0">2024 å¹´ 6 æœˆ 14 æ—¥</div><div class="flex flex-nowrap max-w-full overflow-x-auto article-tags"><a href="/nobelium/tag/React"><p class="mr-1 rounded-full px-2 py-1 border leading-none text-sm dark:border-gray-600">React</p></a><a href="/nobelium/tag/Next.js"><p class="mr-1 rounded-full px-2 py-1 border leading-none text-sm dark:border-gray-600">Next.js</p></a><a href="/nobelium/tag/Website"><p class="mr-1 rounded-full px-2 py-1 border leading-none text-sm dark:border-gray-600">Website</p></a><a href="/nobelium/tag/JavaScript"><p class="mr-1 rounded-full px-2 py-1 border leading-none text-sm dark:border-gray-600">JavaScript</p></a></div><div> <img src="https://www.notion.so/images/page-cover/rijksmuseum_mignons_1660.jpg"/> </div></nav><div class="-mt-4"><main class="notion light-mode notion-page notion-block-98540d4118794bea9bdffa17af5cc06e"><div class="notion-viewport"></div><div class="notion-collection-row"><div class="notion-collection-row-body"><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M10.889 5.5H3.11v1.556h7.778V5.5zm1.555-4.444h-.777V0H10.11v1.056H3.89V0H2.333v1.056h-.777c-.864 0-1.548.7-1.548 1.555L0 12.5c0 .856.692 1.5 1.556 1.5h10.888C13.3 14 14 13.356 14 12.5V2.611c0-.855-.7-1.555-1.556-1.555zm0 11.444H1.556V3.944h10.888V12.5zM8.556 8.611H3.11v1.556h5.445V8.61z"></path></svg><div class="notion-collection-column-title-body">date</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-date">Jun 14, 2024</span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 4.568a.5.5 0 00-.5-.5h-6a.5.5 0 00-.5.5v1.046a.5.5 0 00.5.5h6a.5.5 0 00.5-.5V4.568zM.5 1a.5.5 0 00-.5.5v1.045a.5.5 0 00.5.5h12a.5.5 0 00.5-.5V1.5a.5.5 0 00-.5-.5H.5zM0 8.682a.5.5 0 00.5.5h11a.5.5 0 00.5-.5V7.636a.5.5 0 00-.5-.5H.5a.5.5 0 00-.5.5v1.046zm0 3.068a.5.5 0 00.5.5h9a.5.5 0 00.5-.5v-1.045a.5.5 0 00-.5-.5h-9a.5.5 0 00-.5.5v1.045z"></path></svg><div class="notion-collection-column-title-body">slug</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-text">Promptopia-dev-note-state-ref-and-async</span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 13A6 6 0 107 1a6 6 0 000 12zM3.751 5.323A.2.2 0 013.909 5h6.182a.2.2 0 01.158.323L7.158 9.297a.2.2 0 01-.316 0L3.751 5.323z"></path></svg><div class="notion-collection-column-title-body">status</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-select"><div class="notion-property-select-item notion-item-red">Published</div></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M4 3a1 1 0 011-1h7a1 1 0 110 2H5a1 1 0 01-1-1zm0 4a1 1 0 011-1h7a1 1 0 110 2H5a1 1 0 01-1-1zm0 4a1 1 0 011-1h7a1 1 0 110 2H5a1 1 0 01-1-1zM2 4a1 1 0 110-2 1 1 0 010 2zm0 4a1 1 0 110-2 1 1 0 010 2zm0 4a1 1 0 110-2 1 1 0 010 2z"></path></svg><div class="notion-collection-column-title-body">tags</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-multi_select"><div class="notion-property-multi_select-item notion-item-gray">React</div><div class="notion-property-multi_select-item notion-item-green">Next.js</div><div class="notion-property-multi_select-item notion-item-pink">Website</div><div class="notion-property-multi_select-item notion-item-pink">JavaScript</div></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 4.568a.5.5 0 00-.5-.5h-6a.5.5 0 00-.5.5v1.046a.5.5 0 00.5.5h6a.5.5 0 00.5-.5V4.568zM.5 1a.5.5 0 00-.5.5v1.045a.5.5 0 00.5.5h12a.5.5 0 00.5-.5V1.5a.5.5 0 00-.5-.5H.5zM0 8.682a.5.5 0 00.5.5h11a.5.5 0 00.5-.5V7.636a.5.5 0 00-.5-.5H.5a.5.5 0 00-.5.5v1.046zm0 3.068a.5.5 0 00.5.5h9a.5.5 0 00.5-.5v-1.045a.5.5 0 00-.5-.5h-9a.5.5 0 00-.5.5v1.045z"></path></svg><div class="notion-collection-column-title-body">summary</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-text">ä»ä¸€æ¬¡ debug ç»å†å‡ºå‘ï¼Œè®²è®² JS é‡Œçš„å¼‚æ­¥æœºåˆ¶å¦‚ä½•å½±å“ä½ çš„ä»£ç æ‰§è¡Œï¼Ÿ</span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 13A6 6 0 107 1a6 6 0 000 12zM3.751 5.323A.2.2 0 013.909 5h6.182a.2.2 0 01.158.323L7.158 9.297a.2.2 0 01-.316 0L3.751 5.323z"></path></svg><div class="notion-collection-column-title-body">type</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-select"><div class="notion-property-select-item notion-item-purple">Post</div></span></div></div></div></div><h3 class="notion-h notion-h2 notion-h-indent-0 notion-block-6255bd867ed4427ab36891a172384f60" data-id="6255bd867ed4427ab36891a172384f60"><span><div id="6255bd867ed4427ab36891a172384f60" class="notion-header-anchor"></div><a class="notion-hash-link" href="#6255bd867ed4427ab36891a172384f60" title="å‰è¨€"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">å‰è¨€</span></span></h3><div class="notion-text notion-block-69a41e6cf8e642a7bfd142dc85b3c7cf">ä¹¦æ¥ä¸Šå›ï¼Œæˆ‘åœ¨å®ç°äº†æœç´¢åŠŸèƒ½åï¼Œæ‰“ç®—è¿›ä¸€æ­¥å®ç° <code class="notion-inline-code">tag</code> çš„ç‚¹å‡»åŠŸèƒ½ï¼Œæˆ‘çš„æƒ³æ³•å¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨ç‚¹å‡» <code class="notion-inline-code">tag</code> åå°† <code class="notion-inline-code">searchText</code> è¿™ä¸ªå˜é‡è®¾ä¸º tag çš„å€¼ï¼Œç„¶åæ¸…é™¤æ‰ç”± useEffect è®¾ç½®çš„å®šæ—¶å™¨ï¼Œæœ€åæ‰‹åŠ¨æ ¹æ®<code class="notion-inline-code">searchText</code> å‘ä¸ªè¯·æ±‚æ›´æ–°ä¸€ä¸‹ feed å°±å®Œäº‹äº†ï¼Œæ²¡æƒ³åˆ°è¿™ä¸ªè¿‡ç¨‹ç«Ÿç„¶è®©æˆ‘é‡åˆ°äº†å¼‚æ­¥è¿™ä¸ªå¤§å‘ã€‚</div><h3 class="notion-h notion-h2 notion-h-indent-0 notion-block-09a9f67f1a2042b299bce3e34fe82204" data-id="09a9f67f1a2042b299bce3e34fe82204"><span><div id="09a9f67f1a2042b299bce3e34fe82204" class="notion-header-anchor"></div><a class="notion-hash-link" href="#09a9f67f1a2042b299bce3e34fe82204" title="ä¸å¯é¢„è§å’Œéš¾ä»¥ç†è§£çš„å¼‚æ­¥è¡Œä¸º"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">ä¸å¯é¢„è§å’Œéš¾ä»¥ç†è§£çš„å¼‚æ­¥è¡Œä¸º</span></span></h3><pre class="notion-code language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">[</span>searchText<span class="token punctuation">,</span> setSearchText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initialSearchText<span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>timeoutId<span class="token punctuation">,</span> setTimeoutId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token comment">// æ ¹æ®æœç´¢å…³é”®è¯è·å– prompt</span>
<span class="token keyword">const</span> <span class="token function-variable function">fetchSearchPosts</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/api/prompt/search?searchText='</span> <span class="token operator">+</span> searchText<span class="token punctuation">)</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">setPosts</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// é˜²æŠ–</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>searchText<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> newTimeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fetch by useEffect, searchText now: '</span><span class="token punctuation">,</span> searchText<span class="token punctuation">)</span>
      <span class="token function">fetchSearchPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token function">setTimeoutId</span><span class="token punctuation">(</span>newTimeout<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'set!'</span><span class="token punctuation">,</span> newTimeout<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span>newTimeout<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">fetchPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutId<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>searchText<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleTagClick</span> <span class="token operator">=</span> <span class="token parameter">tag</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">setSearchText</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span>
  
  <span class="token comment">// ç«‹å³è§¦å‘ç±»å‹ï¼Œæ¸…é™¤å®šæ—¶å™¨</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'clear by tag'</span><span class="token punctuation">,</span> timeoutId<span class="token punctuation">)</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutId<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fetch by tag, searchText now: '</span><span class="token punctuation">,</span> searchText<span class="token punctuation">)</span>
    <span class="token function">fetchSearchPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><div class="notion-text notion-block-e341689b004645c2854844a94dfd2beb">ç¨‹åºçš„æ‰§è¡Œå…¥å£æ˜¯<code class="notion-inline-code">handleTagClick</code> ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆä»è¿™ä¸ªéƒ¨åˆ†çœ‹èµ·ï¼Œæ•´æ®µç¨‹åºæ¶‰åŠä¸¤ä¸ª<code class="notion-inline-code">setTimeout</code> ï¼Œä¸¤ä¸ª <code class="notion-inline-code">state</code> å˜é‡ï¼Œæˆ‘ä»¬é€šè¿‡ console.log() æ¥ææ¸…æ¥šè¿™äº›ä»£ç æ‰§è¡Œçš„é¡ºåºã€‚</div><ol start="1" class="notion-list notion-list-numbered notion-block-27e94cd47ed04ec1aeda1e2aaf9c8fe4"><li><code class="notion-inline-code">setSearchText(tag)</code> è§¦å‘<code class="notion-inline-code">useEffect</code> ï¼Œé¦–å…ˆæ‰§è¡Œ<code class="notion-inline-code">useEffect</code> å†…çš„éƒ¨åˆ†ï¼›</li></ol><ol start="2" class="notion-list notion-list-numbered notion-block-ba49b083af8743ada94959454f1ca137"><li><code class="notion-inline-code">const newTimeout = setTimeout</code> æˆä¸ºä¸‹ä¸€ä¸ªå®ä»»åŠ¡ï¼Œæš‚æ—¶æŒ‚èµ·ï¼›</li></ol><ol start="3" class="notion-list notion-list-numbered notion-block-3562e595da77401fa2f91a8a3acaf2c4"><li><code class="notion-inline-code">setTimeoutId(newTimeout)</code> å°† <code class="notion-inline-code">timeoutId</code> æ›´æ–°ä¸ºæœ€æ–°çš„è®¡æ—¶å™¨ï¼›</li></ol><ol start="4" class="notion-list notion-list-numbered notion-block-5cdfca3789fd42288503cc10561b4f61"><li>æ‰“å° <code class="notion-inline-code">â€˜set!â€™, 127</code> </li></ol><ol start="5" class="notion-list notion-list-numbered notion-block-1d0eaf7b622e471f9581823dab52b9e4"><li>ç»§ç»­æ‰§è¡Œ<code class="notion-inline-code">handleTagClick</code> ä¸­å‰©ä½™çš„ä»£ç </li><ol class="notion-list notion-list-numbered notion-block-1d0eaf7b622e471f9581823dab52b9e4"><pre class="notion-code language-javascript"><code class="language-javascript"><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'clear by tag'</span><span class="token punctuation">,</span> timeoutId<span class="token punctuation">)</span>
  <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutId<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fetch by tag, searchText now: '</span><span class="token punctuation">,</span> searchText<span class="token punctuation">)</span>
  <span class="token function">fetchSearchPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></code></pre><div class="notion-text notion-block-43ab05efcdc74340910a02754d13db0e">æ‰“å°<code class="notion-inline-code">&#x27;clear by tag 120&#x27;</code> </div></ol></ol><ol start="6" class="notion-list notion-list-numbered notion-block-9af3aa9402de416ba5d4577c6cb8ca7e"><li>æ ¹æ®æ—§çš„ <code class="notion-inline-code">searchText</code> å‘é€è¯·æ±‚<code class="notion-inline-code">fetchSearchPosts()</code> </li></ol><ol start="7" class="notion-list notion-list-numbered notion-block-3433ce67c9894e71b7dbb0aef42dd2fd"><li>ç­‰å¾… 1s çš„æ—¶é—´åï¼Œæ‰§è¡Œ</li><ol class="notion-list notion-list-numbered notion-block-3433ce67c9894e71b7dbb0aef42dd2fd"><pre class="notion-code language-javascript"><code class="language-javascript"><span class="token keyword">const</span> newTimeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fetch by useEffect, searchText now: '</span><span class="token punctuation">,</span> searchText<span class="token punctuation">)</span>
  <span class="token function">fetchSearchPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span></code></pre><div class="notion-text notion-block-c355e7658a2948b5be8acf60e88d59a9">å†…éƒ¨çš„ä»£ç ï¼Œæ ¹æ®æœ€æ–°çš„<code class="notion-inline-code">searchText</code> å‘é€è¯·æ±‚</div></ol></ol><div class="notion-text notion-block-3a42b658892b47caa9b9fd93bf552d05">æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå‡ºç°äº†ä¸¤ä¸ªæ²¡æœ‰é¢„æœŸçš„è¡Œä¸ºï¼š</div><ol start="1" class="notion-list notion-list-numbered notion-block-2244ceb444fc4bfaafa2eb7f152a3cbd"><li>å®šæ—¶å™¨æ¸…ç†å¤±è´¥</li></ol><ol start="2" class="notion-list notion-list-numbered notion-block-59ab94bb67984a62b3e856e2fe2fe157"><li>ç”±äºå®šæ—¶å™¨æ¸…ç†å¤±è´¥ï¼Œå‘é€äº†ä¸¤æ¬¡è¯·æ±‚ï¼Œä½†ç”±æœ¬ä¸è¯¥å‘é€çš„é‚£æ¬¡è¯·æ±‚å®Œæˆäº†åŠŸèƒ½ï¼ˆå³ <code class="notion-inline-code">useEffect</code> å†…æœ¬æ¥è¢«æ¸…ç†çš„è¯·æ±‚ï¼‰ï¼Œè€Œæœ¬æ¥å‘æŒ¥ä½œç”¨çš„ï¼Œåœ¨<code class="notion-inline-code">handleClick</code> å†…çš„è¯·æ±‚å´å‘é€äº†é”™è¯¯çš„è¯·æ±‚ï¼ˆ<code class="notion-inline-code">searchText</code>æ›´æ–°å‰çš„å†…å®¹ï¼Œå³ç‚¹å‡» tag å‰çš„æ–‡æœ¬æ¡†å†…å®¹ï¼‰</li></ol><div class="notion-text notion-block-734b7d5092c64602b5ed042c826076dc">ä¸‹é¢æˆ‘ä»¬è¿›è¡Œé€ä¸€åˆ†æ</div><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-925fd5a87c934d65bf0d531ad30af318" data-id="925fd5a87c934d65bf0d531ad30af318"><span><div id="925fd5a87c934d65bf0d531ad30af318" class="notion-header-anchor"></div><a class="notion-hash-link" href="#925fd5a87c934d65bf0d531ad30af318" title="å®šæ—¶å™¨æ¸…ç†å¤±è´¥"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">å®šæ—¶å™¨æ¸…ç†å¤±è´¥</span></span></h4><div class="notion-text notion-block-ee2452f75f2a4019aa21ab8748957e4a">è§‚å¯Ÿæ‰§è¡Œé¡ºåºæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š<b>è™½ç„¶</b><code class="notion-inline-code"><b>handleTagClick</b></code><b>ä¸­çš„</b><code class="notion-inline-code"><b>setTimeout</b></code><b> æ›´æ™šæ‰§è¡Œï¼Œä½†ä»–è·å–åˆ°çš„å´ä¸æ˜¯æœ€æ–°çš„</b><code class="notion-inline-code"><b>timeoutId</b></code><b> ï¼</b>è¿™æ˜¯å› ä¸º JS çš„<b>é—­åŒ…æœºåˆ¶</b>ï¼Œä½¿å¾—<code class="notion-inline-code">handleTagClick</code>å†…çš„<code class="notion-inline-code">setTimeout</code>æ•è·äº†ä¸å®ƒå¹³çº§çš„ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯è¯´å³ä½¿å®ƒæ›´æ™šæ‰§è¡Œï¼Œä½†è·å¾—çš„<code class="notion-inline-code">timeoutId</code> å®é™…ä¸Šè·Ÿç´§è·Ÿåœ¨<code class="notion-inline-code">setSearchText(tag)</code> åè·å–çš„<code class="notion-inline-code">timeoutId</code> æ˜¯ä¸€æ ·çš„ï¼Œè¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆæ˜æ˜ <code class="notion-inline-code">set</code> åœ¨å…ˆï¼Œ<code class="notion-inline-code">clear</code> åœ¨åï¼Œä½† <code class="notion-inline-code">clear</code> çš„å´ä¸æ˜¯è¯¥ <code class="notion-inline-code">clear</code> çš„é‚£ä¸ªè®¡æ—¶å™¨ã€‚</div><div class="notion-callout notion-gray_background_co notion-block-effaff2a1e314af097b169ba984d22a6"><span class="notion-page-icon" role="img" aria-label="ğŸ’¡">ğŸ’¡</span><div class="notion-callout-text"><code class="notion-inline-code">state</code> å˜é‡çš„æ›´æ–°æ˜¯å¼‚æ­¥çš„ï¼Œè·å–åˆ°çš„å€¼å¯èƒ½å¹¶ä¸ç¬¦åˆä½ çš„é¢„æœŸï¼Œå¦‚æœä½ éœ€è¦è·å–æ ¹æ® state å˜é‡çš„æœ€æ–°å€¼è¿›è¡Œæ“ä½œï¼Œä½ æ°¸è¿œåº”è¯¥ä½¿ç”¨ useEffect æ¥ç›‘å¬è¿™ä¸ªå˜é‡è·å¾—æœ€æ–°å€¼ã€‚</div></div><div class="notion-text notion-block-1ae8ed2a2fc1489a9336e7c3feee8293">å®šä½åˆ°äº†é—®é¢˜ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•è§£å†³å‘¢ï¼Œå…¶å®åœ¨<a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://zh-hans.react.dev/learn/referencing-values-with-refs">å®˜æ–¹æ–‡æ¡£</a>ä¸­ï¼Œå°±å·²ç»æ¨èäº†ä½¿ç”¨ <code class="notion-inline-code">useRef</code> æ¥å­˜å‚¨<code class="notion-inline-code">timeoutId</code> ï¼Œå› ä¸º <code class="notion-inline-code">state</code> çš„æ›´æ–°æ˜¯å¼‚æ­¥çš„ï¼Œä½† <code class="notion-inline-code">useRef</code> çš„æ›´æ–°æ˜¯åŒæ­¥çš„ï¼Œä½ è·å–åˆ°çš„æ°¸è¿œæ˜¯æœ€æ–°çš„å€¼ï¼æˆ‘ä»¬æ¥çœ‹çœ‹ useRef å¦‚ä½•å¸®åŠ©æˆ‘ä»¬çªå‡ºé—­åŒ…æœºåˆ¶çš„é‡å›´ï¼š</div><pre class="notion-code language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">[</span>searchText<span class="token punctuation">,</span> setSearchText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initialSearchText<span class="token punctuation">)</span>
<span class="token keyword">const</span> timeoutId <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleTagClick</span> <span class="token operator">=</span> <span class="token parameter">tag</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">setSearchText</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span>
  <span class="token comment">// éœ€è¦ç­‰å¾…searchTextæ›´æ–°å®Œæ¯•ï¼Œå†æ¸…é™¤å‰¯ä½œç”¨å¸¦æ¥çš„å®šæ—¶å™¨</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'clear by tag'</span><span class="token punctuation">,</span> timeoutId<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutId<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token function">fetchSearchPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// ç«‹å³æ‰§è¡Œæœç´¢</span>
<span class="token punctuation">}</span></code></pre><div class="notion-text notion-block-41bfecf6ed1f494cb9b453d03856b7f5">åªåœ¨æˆ‘ä»¬ä¸å…³å¿ƒä¾¦å¬<code class="notion-inline-code">searchText</code>çš„ <code class="notion-inline-code">useEffect</code> å†…å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæˆ‘ä»¬åªå…³å¿ƒå°† <code class="notion-inline-code">timeoutId</code> æ¢ç”¨ <code class="notion-inline-code">useRef</code> å­˜å‚¨åä¸ºä»€ä¹ˆå°±èƒ½è§£å†³é—®é¢˜ï¼Ÿ</div><div class="notion-text notion-block-7f923ba036664aec8daa5dd3d72119d8">æ ¹æ®é—­åŒ…æœºåˆ¶ï¼Œ<code class="notion-inline-code">handleTagClick&gt;setTimeout</code> ä¾æ—§æ•è·äº†è·Ÿ<code class="notion-inline-code">setSearchText(tag)</code> å¹³çº§çš„<code class="notion-inline-code">timeoutId</code> ï¼Œè¿™ä¸ªå˜é‡ä¾æ—§æ˜¯ä¸å˜çš„ï¼Œä½†è¿™ä¸ªå˜é‡å®é™…ä¸ŠæŒ‡å‘äº†ä¸€ä¸ª <code class="notion-inline-code">ref</code> å¯¹è±¡ï¼Œæˆ‘ä»¬é€šè¿‡å…¶<code class="notion-inline-code">current</code> å±æ€§æ¥è®¿é—®å®ƒçš„å€¼ï¼Œå› è€Œåœ¨<code class="notion-inline-code">useEffect</code> å†…å‘ç”Ÿçš„æ”¹å˜ï¼Œä¾æ—§ä½œç”¨åˆ°äº†è¿™é‡Œçš„<code class="notion-inline-code">timeoutId</code>ä¸Šï¼ŒæˆåŠŸè®©æˆ‘ä»¬è·å–åˆ°äº†æœ€æ–°çš„<code class="notion-inline-code">timeoutId</code>ï¼</div><div class="notion-callout notion-gray_background_co notion-block-23eba2115acf4ec6b283c01a23f63a62"><span class="notion-page-icon" role="img" aria-label="ğŸ’¡">ğŸ’¡</span><div class="notion-callout-text"><code class="notion-inline-code">useRef</code> æ°¸è¿œæ˜¯æœ€æ–°çš„ï¼</div></div><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-d1268d43d75542aeb58cb7e73067d85c" data-id="d1268d43d75542aeb58cb7e73067d85c"><span><div id="d1268d43d75542aeb58cb7e73067d85c" class="notion-header-anchor"></div><a class="notion-hash-link" href="#d1268d43d75542aeb58cb7e73067d85c" title="è¯·æ±‚é”™è¯¯"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">è¯·æ±‚é”™è¯¯</span></span></h4><div class="notion-text notion-block-3eb53ca39ce74e26a76a7b0b03b43292">åœ¨æˆåŠŸä¿®å¤äº†å®šæ—¶å™¨æ¸…ç†å¤±æ•ˆçš„é—®é¢˜åï¼Œæˆ‘ä»¬ä¹Ÿå°±åªä¼šå‘é€ä¸€æ¬¡è¯·æ±‚äº†ï¼Œä¹Ÿå°±æ˜¯<code class="notion-inline-code">handleTagClick</code> ä¸­çš„è¯·æ±‚ï¼Œä½†æ ¹æ®å‰æ–‡æåˆ°çš„é—­åŒ…æœºåˆ¶ï¼Œè¿™é‡Œ<code class="notion-inline-code">fetchSearchPosts()</code> ä½¿ç”¨çš„ä¾æ—§æ˜¯æ—§çš„å€¼ï¼Œé’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„é€šè¿‡ä¿®æ”¹<code class="notion-inline-code">fetchSearchPosts()</code> æ¥å®ç°ï¼Œæˆ‘ä»¬è®©å®ƒä¸è¦å†ä¾èµ–å¤–éƒ¨çš„ <code class="notion-inline-code">searchText</code> æ¥è¿›è¡Œæœç´¢ï¼Œè€Œæ˜¯ä¼ å…¥ä¸€ä¸ªå€¼ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ tag çš„å€¼æ¥è¿›è¡Œæœç´¢ï¼Œä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š</div><pre class="notion-code language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">const</span> useSearchPosts <span class="token operator">=</span> <span class="token punctuation">(</span>initialSearchText <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>searchText<span class="token punctuation">,</span> setSearchText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initialSearchText<span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>posts<span class="token punctuation">,</span> setPosts<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> timeoutId <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>

  <span class="token comment">// è·å–æ‰€æœ‰ prompt</span>
  <span class="token keyword">const</span> <span class="token function-variable function">fetchPosts</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/api/prompt'</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">setPosts</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// æ ¹æ®æœç´¢å…³é”®è¯è·å– prompt</span>
  <span class="token keyword">const</span> <span class="token function-variable function">fetchSearchPosts</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token parameter">search</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/api/prompt/search?searchText='</span> <span class="token operator">+</span> search<span class="token punctuation">)</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">setPosts</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">fetchPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token comment">// é˜²æŠ–</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>searchText<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> newTimeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">fetchSearchPosts</span><span class="token punctuation">(</span>searchText<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
      timeoutId<span class="token punctuation">.</span>current <span class="token operator">=</span> newTimeout
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'set!'</span><span class="token punctuation">,</span> newTimeout<span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span>newTimeout<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">fetchPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutId<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>searchText<span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleSearchChange</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setSearchText</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleSubmit</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'clear by submit'</span><span class="token punctuation">,</span> timeoutId<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutId<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
    <span class="token function">fetchSearchPosts</span><span class="token punctuation">(</span>searchText<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleTagClick</span> <span class="token operator">=</span> <span class="token parameter">tag</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setSearchText</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span>
    <span class="token comment">// éœ€è¦ç­‰å¾…searchTextæ›´æ–°å®Œæ¯•ï¼Œå†æ¸…é™¤å‰¯ä½œç”¨å¸¦æ¥çš„å®šæ—¶å™¨</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'clear by tag'</span><span class="token punctuation">,</span> timeoutId<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutId<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token function">fetchSearchPosts</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span> <span class="token comment">// ç«‹å³æ‰§è¡Œæœç´¢</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    searchText<span class="token punctuation">,</span>
    posts<span class="token punctuation">,</span>
    fetchPosts<span class="token punctuation">,</span>
    handleSearchChange<span class="token punctuation">,</span>
    handleSubmit<span class="token punctuation">,</span>
    handleTagClick
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useSearchPosts</code></pre><div class="notion-callout notion-gray_background_co notion-block-632f63b39d4f43ff8a0ce2a1cd59cf78"><span class="notion-page-icon" role="img" aria-label="ğŸ’¡">ğŸ’¡</span><div class="notion-callout-text">åŸå…ˆçš„<code class="notion-inline-code">fetchSearchPosts</code> å®Œå…¨ä¾èµ–äº <code class="notion-inline-code">searchText</code> è¿™ä¸ªå˜é‡ï¼Œä¸èƒ½æ ¹æ®ä¼ å…¥å‚æ•°åŠ¨æ€å†³å®šè¯·æ±‚å‚æ•°ï¼Œè¿™æ ·å†™å¹¶ä¸åˆç†ï¼›å†åŠ ä¸Šæˆ‘ä»¬ç‚¹å‡» tag åï¼Œæˆ‘ä»¬è®¾ç½®<code class="notion-inline-code">searchText</code> å®Œå…¨æ˜¯ä¸ºäº†è®©æœç´¢æ¡†èƒ½æ˜¾ç¤ºæˆ‘ä»¬ç‚¹å‡»çš„å†…å®¹ï¼Œè€Œå‘é€è¯·æ±‚å°±æ²¡å¿…è¦å†’ç€å˜é‡ä¸æ˜¯æœ€æ–°çš„é£é™©ç”¨<code class="notion-inline-code">searchText</code> äº†ï¼Œå®Œå…¨å¯ä»¥ç”¨ <code class="notion-inline-code">tag</code> æ¥å‘é€è¯·æ±‚ã€‚</div></div></main></div></article><div class="flex justify-between font-medium text-gray-500 dark:text-gray-400"><a><button class="mt-2 cursor-pointer hover:text-black dark:hover:text-gray-100">â† <!-- -->è¿”å›</button></a><a><button class="mt-2 cursor-pointer hover:text-black dark:hover:text-gray-100">â†‘ <!-- -->å›åˆ°é¡¶éƒ¨</button></a></div><div></div></main><div class="mt-6 flex-shrink-0 m-auto w-full text-gray-500 dark:text-gray-400 transition-all max-w-3xl px-4"><hr class="border-gray-200 dark:border-gray-600"/><div class="my-4 text-sm leading-6"><div class="flex align-baseline justify-between flex-wrap"><p>Â© <!-- -->Musher<!-- --> <!-- -->2019 - 2024</p><p>powered by <a href="https://github.com/craigary/nobelium"><u>nobelium</u></a></p></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","date":{"start_date":"2024-06-14"},"type":["Post"],"slug":"Promptopia-dev-note-state-ref-and-async","tags":["React","Next.js","Website","JavaScript"],"summary":"ä»ä¸€æ¬¡ debug ç»å†å‡ºå‘ï¼Œè®²è®² JS é‡Œçš„å¼‚æ­¥æœºåˆ¶å¦‚ä½•å½±å“ä½ çš„ä»£ç æ‰§è¡Œï¼Ÿ","title":"Promptopia å¼€å‘ç¬”è®°ï¼ˆ2ï¼‰â€”â€”useStateã€useRefä¸å¼‚æ­¥é€»è¾‘","status":["Published"],"createdTime":"Fri Jun 14 2024 07:06:02 GMT+0000 (Coordinated Universal Time)","fullWidth":false,"pageIcon":"ğŸ§‘â€ğŸ’»","pageCover":"/images/page-cover/rijksmuseum_mignons_1660.jpg"},"blockMap":{"block":{"98540d41-1879-4bea-9bdf-fa17af5cc06e":{"value":{"id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","version":511,"type":"page","properties":{"NX\\Q":[["â€£",[["d",{"type":"date","start_date":"2024-06-14"}]]]],"`gQ~":[["Post"]],"d]hq":[["Promptopia-dev-note-state-ref-and-async"]],"sD^m":[["React,Next.js,Website,JavaScript"]],"wz|S":[["ä»ä¸€æ¬¡ debug ç»å†å‡ºå‘ï¼Œè®²è®² JS é‡Œçš„å¼‚æ­¥æœºåˆ¶å¦‚ä½•å½±å“ä½ çš„ä»£ç æ‰§è¡Œï¼Ÿ"]],"title":[["Promptopia å¼€å‘ç¬”è®°ï¼ˆ2ï¼‰â€”â€”useStateã€useRefä¸å¼‚æ­¥é€»è¾‘"]],"f211bdc0-ee00-4186-9a7d-f68c055ec2ee":[["Published"]]},"content":["6255bd86-7ed4-427a-b368-91a172384f60","69a41e6c-f8e6-42a7-bfd1-42dc85b3c7cf","09a9f67f-1a20-42b2-99bc-e3e34fe82204","eefcf514-fce0-4c5c-b5cf-cafc007bbbee","e341689b-0046-45c2-8548-44a94dfd2beb","27e94cd4-7ed0-4ec1-aeda-1e2aaf9c8fe4","ba49b083-af87-43ad-a949-59454f1ca137","3562e595-da77-401f-a2f9-1a8a3acaf2c4","5cdfca37-89fd-4228-8503-cc10561b4f61","1d0eaf7b-622e-471f-9581-823dab52b9e4","9af3aa94-02de-416b-a5d4-577c6cb8ca7e","3433ce67-c989-4e71-b7db-b0aef42dd2fd","3a42b658-892b-47ca-a9b9-fd93bf552d05","2244ceb4-44fc-4bfa-afa2-eb7f152a3cbd","59ab94bb-6798-4a62-b3e8-56e2fe2fe157","734b7d50-92c6-4602-b5ed-042c826076dc","925fd5a8-7c93-4d65-bf0d-531ad30af318","ee2452f7-5f2a-4019-aa21-ab8748957e4a","effaff2a-1e31-4af0-97b1-69ba984d22a6","1ae8ed2a-2fc1-489a-9336-e7c3feee8293","b054aff3-190b-4655-a8f3-b65f79674003","41bfecf6-ed1f-494c-b9b4-53d03856b7f5","7f923ba0-3666-4aec-8daa-5dd3d72119d8","23eba211-5acf-4ec6-b283-c01a23f63a62","d1268d43-d755-42ae-b58c-b7e73067d85c","3eb53ca3-9ce7-4e26-a76a-7b0b03b43292","60364b4a-11c1-4f94-9503-d918334568c1","632f63b3-9d4f-43ff-8a0c-e2a1cd59cf78"],"format":{"page_icon":"ğŸ§‘â€ğŸ’»","page_cover":"/images/page-cover/rijksmuseum_mignons_1660.jpg","page_full_width":false,"page_cover_position":0.5},"created_time":1718348762579,"last_edited_time":1718595215349,"parent_id":"4126d965-c550-46af-bc34-c038f0103084","parent_table":"collection","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"0eb813c6-179c-43e0-8c12-27cc22341e33":{"value":{"id":"0eb813c6-179c-43e0-8c12-27cc22341e33","version":37,"type":"collection_view_page","view_ids":["1df80a31-46e8-4fcd-b9a3-dde8ded944c9"],"collection_id":"4126d965-c550-46af-bc34-c038f0103084","format":{"block_locked":false,"block_locked_by":"2c0e0b01-f59e-4e03-b7b6-7d706eecada3","collection_pointer":{"id":"4126d965-c550-46af-bc34-c038f0103084","table":"collection","spaceId":"01ff42de-5b53-40d7-a69e-999e3574e640"},"copied_from_pointer":{"id":"ee99f65a-23ab-44f8-ac80-270122ee8138","table":"block","spaceId":"b3580129-1025-4b78-9e73-0a6f39f464ab"}},"permissions":[{"role":"editor","type":"user_permission","user_id":"4e783237-cc83-440e-9604-bac369009c55"},{"role":"reader","type":"public_permission","added_timestamp":1716963272589}],"created_time":1716962484995,"last_edited_time":1718352944249,"parent_id":"01ff42de-5b53-40d7-a69e-999e3574e640","parent_table":"space","alive":true,"copied_from":"ee99f65a-23ab-44f8-ac80-270122ee8138","created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"6255bd86-7ed4-427a-b368-91a172384f60":{"value":{"id":"6255bd86-7ed4-427a-b368-91a172384f60","version":23,"type":"sub_header","properties":{"title":[["å‰è¨€"]]},"created_time":1718353106942,"last_edited_time":1718353111234,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"69a41e6c-f8e6-42a7-bfd1-42dc85b3c7cf":{"value":{"id":"69a41e6c-f8e6-42a7-bfd1-42dc85b3c7cf","version":822,"type":"text","properties":{"title":[["ä¹¦æ¥ä¸Šå›ï¼Œæˆ‘åœ¨å®ç°äº†æœç´¢åŠŸèƒ½åï¼Œæ‰“ç®—è¿›ä¸€æ­¥å®ç° "],["tag",[["c"]]],[" çš„ç‚¹å‡»åŠŸèƒ½ï¼Œæˆ‘çš„æƒ³æ³•å¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨ç‚¹å‡» "],["tag",[["c"]]],[" åå°† "],["searchText",[["c"]]],[" è¿™ä¸ªå˜é‡è®¾ä¸º tag çš„å€¼ï¼Œç„¶åæ¸…é™¤æ‰ç”± useEffect è®¾ç½®çš„å®šæ—¶å™¨ï¼Œæœ€åæ‰‹åŠ¨æ ¹æ®"],["searchText",[["c"]]],[" å‘ä¸ªè¯·æ±‚æ›´æ–°ä¸€ä¸‹ feed å°±å®Œäº‹äº†ï¼Œæ²¡æƒ³åˆ°è¿™ä¸ªè¿‡ç¨‹ç«Ÿç„¶è®©æˆ‘é‡åˆ°äº†å¼‚æ­¥è¿™ä¸ªå¤§å‘ã€‚"]]},"created_time":1718352995055,"last_edited_time":1718353898091,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"09a9f67f-1a20-42b2-99bc-e3e34fe82204":{"value":{"id":"09a9f67f-1a20-42b2-99bc-e3e34fe82204","version":187,"type":"sub_header","properties":{"title":[["ä¸å¯é¢„è§å’Œéš¾ä»¥ç†è§£çš„å¼‚æ­¥è¡Œä¸º"]]},"created_time":1718353788580,"last_edited_time":1718353814396,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"eefcf514-fce0-4c5c-b5cf-cafc007bbbee":{"value":{"id":"eefcf514-fce0-4c5c-b5cf-cafc007bbbee","version":211,"type":"code","properties":{"title":[["const [searchText, setSearchText] = useState(initialSearchText)\nconst [timeoutId, setTimeoutId] = useState(null)\n// æ ¹æ®æœç´¢å…³é”®è¯è·å– prompt\nconst fetchSearchPosts = async () =\u003e {\n  const response = await fetch('/api/prompt/search?searchText=' + searchText)\n  const data = await response.json()\n  setPosts(data)\n}\n// é˜²æŠ–\nuseEffect(() =\u003e {\n  if (searchText.trim()) {\n    const newTimeout = setTimeout(() =\u003e {\n      console.log('fetch by useEffect, searchText now: ', searchText)\n      fetchSearchPosts()\n    }, 1000)\n    setTimeoutId(newTimeout)\n    console.log('set!', newTimeout)\n    return () =\u003e clearTimeout(newTimeout)\n  } else {\n    fetchPosts()\n    return () =\u003e clearTimeout(timeoutId)\n  }\n}, [searchText])\nconst handleTagClick = tag =\u003e {\n  setSearchText(tag)\n  \n  // ç«‹å³è§¦å‘ç±»å‹ï¼Œæ¸…é™¤å®šæ—¶å™¨\n  setTimeout(() =\u003e {\n    console.log('clear by tag', timeoutId)\n    clearTimeout(timeoutId)\n    console.log('fetch by tag, searchText now: ', searchText)\n    fetchSearchPosts()\n  }, 0)\n}"]],"language":[["JavaScript"]]},"created_time":1718353123637,"last_edited_time":1718376720486,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"e341689b-0046-45c2-8548-44a94dfd2beb":{"value":{"id":"e341689b-0046-45c2-8548-44a94dfd2beb","version":587,"type":"text","properties":{"title":[["ç¨‹åºçš„æ‰§è¡Œå…¥å£æ˜¯"],["handleTagClick",[["c"]]],[" ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆä»è¿™ä¸ªéƒ¨åˆ†çœ‹èµ·ï¼Œæ•´æ®µç¨‹åºæ¶‰åŠä¸¤ä¸ª"],["setTimeout",[["c"]]],[" ï¼Œä¸¤ä¸ª "],["state",[["c"]]],[" å˜é‡ï¼Œæˆ‘ä»¬é€šè¿‡ console.log() æ¥ææ¸…æ¥šè¿™äº›ä»£ç æ‰§è¡Œçš„é¡ºåºã€‚"]]},"created_time":1718353054901,"last_edited_time":1718353984057,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"27e94cd4-7ed0-4ec1-aeda-1e2aaf9c8fe4":{"value":{"id":"27e94cd4-7ed0-4ec1-aeda-1e2aaf9c8fe4","version":176,"type":"numbered_list","properties":{"title":[["setSearchText(tag)",[["c"]]],[" è§¦å‘"],["useEffect",[["c"]]],[" ï¼Œé¦–å…ˆæ‰§è¡Œ"],["useEffect",[["c"]]],[" å†…çš„éƒ¨åˆ†ï¼›"]]},"created_time":1718353984341,"last_edited_time":1718354068328,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"ba49b083-af87-43ad-a949-59454f1ca137":{"value":{"id":"ba49b083-af87-43ad-a949-59454f1ca137","version":75,"type":"numbered_list","properties":{"title":[["const newTimeout = setTimeout",[["c"]]],[" æˆä¸ºä¸‹ä¸€ä¸ªå®ä»»åŠ¡ï¼Œæš‚æ—¶æŒ‚èµ·ï¼›"]]},"created_time":1718354068482,"last_edited_time":1718354091972,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"3562e595-da77-401f-a2f9-1a8a3acaf2c4":{"value":{"id":"3562e595-da77-401f-a2f9-1a8a3acaf2c4","version":103,"type":"numbered_list","properties":{"title":[["setTimeoutId(newTimeout)",[["c"]]],[" å°† "],["timeoutId",[["c"]]],[" æ›´æ–°ä¸ºæœ€æ–°çš„è®¡æ—¶å™¨ï¼›"]]},"created_time":1718354092170,"last_edited_time":1718354117050,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"5cdfca37-89fd-4228-8503-cc10561b4f61":{"value":{"id":"5cdfca37-89fd-4228-8503-cc10561b4f61","version":48,"type":"numbered_list","properties":{"title":[["æ‰“å° "],["â€˜set!â€™, 127",[["c"]]],[" "]]},"created_time":1718354118953,"last_edited_time":1718354133719,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"1d0eaf7b-622e-471f-9581-823dab52b9e4":{"value":{"id":"1d0eaf7b-622e-471f-9581-823dab52b9e4","version":226,"type":"numbered_list","properties":{"title":[["ç»§ç»­æ‰§è¡Œ"],["handleTagClick",[["c"]]],[" ä¸­å‰©ä½™çš„ä»£ç "]]},"content":["1d3f1498-d642-4f34-8b4d-57f462a8747c","43ab05ef-cdc7-4340-910a-02754d13db0e"],"created_time":1718354134050,"last_edited_time":1718355870235,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"1d3f1498-d642-4f34-8b4d-57f462a8747c":{"value":{"id":"1d3f1498-d642-4f34-8b4d-57f462a8747c","version":40,"type":"code","properties":{"title":[["setTimeout(() =\u003e {\n  console.log('clear by tag', timeoutId)\n  clearTimeout(timeoutId)\n  console.log('fetch by tag, searchText now: ', searchText)\n  fetchSearchPosts()\n}, 0)"]],"language":[["JavaScript"]]},"created_time":1718354203648,"last_edited_time":1718355047428,"parent_id":"1d0eaf7b-622e-471f-9581-823dab52b9e4","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"43ab05ef-cdc7-4340-910a-02754d13db0e":{"value":{"id":"43ab05ef-cdc7-4340-910a-02754d13db0e","version":1139,"type":"text","properties":{"title":[["æ‰“å°"],["'clear by tag 120'",[["c"]]],[" "]]},"created_time":1718353503736,"last_edited_time":1718355093199,"parent_id":"1d0eaf7b-622e-471f-9581-823dab52b9e4","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"9af3aa94-02de-416b-a5d4-577c6cb8ca7e":{"value":{"id":"9af3aa94-02de-416b-a5d4-577c6cb8ca7e","version":126,"type":"numbered_list","properties":{"title":[["æ ¹æ®æ—§çš„ "],["searchText",[["c"]]],[" å‘é€è¯·æ±‚"],["fetchSearchPosts()",[["c"]]],[" "]]},"created_time":1718355868088,"last_edited_time":1718355899824,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"3433ce67-c989-4e71-b7db-b0aef42dd2fd":{"value":{"id":"3433ce67-c989-4e71-b7db-b0aef42dd2fd","version":64,"type":"numbered_list","properties":{"title":[["ç­‰å¾… 1s çš„æ—¶é—´åï¼Œæ‰§è¡Œ"]]},"content":["5eb1c85a-2d0c-4eb8-95c7-d214746d974a","c355e765-8a29-48b5-be8a-cf60e88d59a9"],"created_time":1718355901970,"last_edited_time":1718356000016,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"5eb1c85a-2d0c-4eb8-95c7-d214746d974a":{"value":{"id":"5eb1c85a-2d0c-4eb8-95c7-d214746d974a","version":42,"type":"code","properties":{"title":[["const newTimeout = setTimeout(() =\u003e {\n  console.log('fetch by useEffect, searchText now: ', searchText)\n  fetchSearchPosts()\n}, 1000)"]],"language":[["JavaScript"]]},"created_time":1718355924615,"last_edited_time":1718355930807,"parent_id":"3433ce67-c989-4e71-b7db-b0aef42dd2fd","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"c355e765-8a29-48b5-be8a-cf60e88d59a9":{"value":{"id":"c355e765-8a29-48b5-be8a-cf60e88d59a9","version":169,"type":"text","properties":{"title":[["å†…éƒ¨çš„ä»£ç ï¼Œæ ¹æ®æœ€æ–°çš„"],["searchText",[["c"]]],[" å‘é€è¯·æ±‚"]]},"created_time":1718355936594,"last_edited_time":1718355956806,"parent_id":"3433ce67-c989-4e71-b7db-b0aef42dd2fd","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"3a42b658-892b-47ca-a9b9-fd93bf552d05":{"value":{"id":"3a42b658-892b-47ca-a9b9-fd93bf552d05","version":230,"type":"text","properties":{"title":[["æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå‡ºç°äº†ä¸¤ä¸ªæ²¡æœ‰é¢„æœŸçš„è¡Œä¸ºï¼š"]]},"created_time":1718355998385,"last_edited_time":1718356016832,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"2244ceb4-44fc-4bfa-afa2-eb7f152a3cbd":{"value":{"id":"2244ceb4-44fc-4bfa-afa2-eb7f152a3cbd","version":58,"type":"numbered_list","properties":{"title":[["å®šæ—¶å™¨æ¸…ç†å¤±è´¥"]]},"created_time":1718356017040,"last_edited_time":1718356022189,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"59ab94bb-6798-4a62-b3e8-56e2fe2fe157":{"value":{"id":"59ab94bb-6798-4a62-b3e8-56e2fe2fe157","version":689,"type":"numbered_list","properties":{"title":[["ç”±äºå®šæ—¶å™¨æ¸…ç†å¤±è´¥ï¼Œå‘é€äº†ä¸¤æ¬¡è¯·æ±‚ï¼Œä½†ç”±æœ¬ä¸è¯¥å‘é€çš„é‚£æ¬¡è¯·æ±‚å®Œæˆäº†åŠŸèƒ½ï¼ˆå³ "],["useEffect",[["c"]]],[" å†…æœ¬æ¥è¢«æ¸…ç†çš„è¯·æ±‚ï¼‰ï¼Œè€Œæœ¬æ¥å‘æŒ¥ä½œç”¨çš„ï¼Œåœ¨"],["handleClick",[["c"]]],[" å†…çš„è¯·æ±‚å´å‘é€äº†é”™è¯¯çš„è¯·æ±‚ï¼ˆ"],["searchText",[["c"]]],["æ›´æ–°å‰çš„å†…å®¹ï¼Œå³ç‚¹å‡» tag å‰çš„æ–‡æœ¬æ¡†å†…å®¹ï¼‰"]]},"created_time":1718356023494,"last_edited_time":1718356118835,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"734b7d50-92c6-4602-b5ed-042c826076dc":{"value":{"id":"734b7d50-92c6-4602-b5ed-042c826076dc","version":95,"type":"text","properties":{"title":[["ä¸‹é¢æˆ‘ä»¬è¿›è¡Œé€ä¸€åˆ†æ"]]},"created_time":1718356122098,"last_edited_time":1718356133522,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"925fd5a8-7c93-4d65-bf0d-531ad30af318":{"value":{"id":"925fd5a8-7c93-4d65-bf0d-531ad30af318","version":51,"type":"sub_sub_header","properties":{"title":[["å®šæ—¶å™¨æ¸…ç†å¤±è´¥"]]},"created_time":1718356134227,"last_edited_time":1718356139832,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"ee2452f7-5f2a-4019-aa21-ab8748957e4a":{"value":{"id":"ee2452f7-5f2a-4019-aa21-ab8748957e4a","version":48,"type":"text","properties":{"title":[["è§‚å¯Ÿæ‰§è¡Œé¡ºåºæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š"],["è™½ç„¶",[["b"]]],["handleTagClick",[["b"],["c"]]],["ä¸­çš„",[["b"]]],["setTimeout",[["b"],["c"]]],[" æ›´æ™šæ‰§è¡Œï¼Œä½†ä»–è·å–åˆ°çš„å´ä¸æ˜¯æœ€æ–°çš„",[["b"]]],["timeoutId",[["b"],["c"]]],[" ï¼",[["b"]]],["è¿™æ˜¯å› ä¸º JS çš„"],["é—­åŒ…æœºåˆ¶",[["b"]]],["ï¼Œä½¿å¾—"],["handleTagClick",[["c"]]],["å†…çš„"],["setTimeout",[["c"]]],["æ•è·äº†ä¸å®ƒå¹³çº§çš„ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯è¯´å³ä½¿å®ƒæ›´æ™šæ‰§è¡Œï¼Œä½†è·å¾—çš„"],["timeoutId",[["c"]]],[" å®é™…ä¸Šè·Ÿç´§è·Ÿåœ¨"],["setSearchText(tag)",[["c"]]],[" åè·å–çš„"],["timeoutId",[["c"]]],[" æ˜¯ä¸€æ ·çš„ï¼Œè¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆæ˜æ˜ "],["set",[["c"]]],[" åœ¨å…ˆï¼Œ"],["clear",[["c"]]],[" åœ¨åï¼Œä½† "],["clear",[["c"]]],[" çš„å´ä¸æ˜¯è¯¥ "],["clear",[["c"]]],[" çš„é‚£ä¸ªè®¡æ—¶å™¨ã€‚"]]},"created_time":1718355093199,"last_edited_time":1718356146847,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"effaff2a-1e31-4af0-97b1-69ba984d22a6":{"value":{"id":"effaff2a-1e31-4af0-97b1-69ba984d22a6","version":720,"type":"callout","properties":{"title":[["state",[["c"]]],[" å˜é‡çš„æ›´æ–°æ˜¯å¼‚æ­¥çš„ï¼Œè·å–åˆ°çš„å€¼å¯èƒ½å¹¶ä¸ç¬¦åˆä½ çš„é¢„æœŸï¼Œå¦‚æœä½ éœ€è¦è·å–æ ¹æ® state å˜é‡çš„æœ€æ–°å€¼è¿›è¡Œæ“ä½œï¼Œä½ æ°¸è¿œåº”è¯¥ä½¿ç”¨ useEffect æ¥ç›‘å¬è¿™ä¸ªå˜é‡è·å¾—æœ€æ–°å€¼ã€‚"]]},"format":{"page_icon":"ğŸ’¡","block_color":"gray_background"},"created_time":1718355531166,"last_edited_time":1718355653646,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"1ae8ed2a-2fc1-489a-9336-e7c3feee8293":{"value":{"id":"1ae8ed2a-2fc1-489a-9336-e7c3feee8293","version":735,"type":"text","properties":{"title":[["å®šä½åˆ°äº†é—®é¢˜ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•è§£å†³å‘¢ï¼Œå…¶å®åœ¨"],["å®˜æ–¹æ–‡æ¡£",[["a","https://zh-hans.react.dev/learn/referencing-values-with-refs"]]],["ä¸­ï¼Œå°±å·²ç»æ¨èäº†ä½¿ç”¨ "],["useRef",[["c"]]],[" æ¥å­˜å‚¨"],["timeoutId",[["c"]]],[" ï¼Œå› ä¸º "],["state",[["c"]]],[" çš„æ›´æ–°æ˜¯å¼‚æ­¥çš„ï¼Œä½† "],["useRef",[["c"]]],[" çš„æ›´æ–°æ˜¯åŒæ­¥çš„ï¼Œä½ è·å–åˆ°çš„æ°¸è¿œæ˜¯æœ€æ–°çš„å€¼ï¼æˆ‘ä»¬æ¥çœ‹çœ‹ useRef å¦‚ä½•å¸®åŠ©æˆ‘ä»¬çªå‡ºé—­åŒ…æœºåˆ¶çš„é‡å›´ï¼š"]]},"created_time":1718355096184,"last_edited_time":1718355238144,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"b054aff3-190b-4655-a8f3-b65f79674003":{"value":{"id":"b054aff3-190b-4655-a8f3-b65f79674003","version":55,"type":"code","properties":{"title":[["const [searchText, setSearchText] = useState(initialSearchText)\nconst timeoutId = useRef(null)\nconst handleTagClick = tag =\u003e {\n  setSearchText(tag)\n  // éœ€è¦ç­‰å¾…searchTextæ›´æ–°å®Œæ¯•ï¼Œå†æ¸…é™¤å‰¯ä½œç”¨å¸¦æ¥çš„å®šæ—¶å™¨\n  setTimeout(() =\u003e {\n    console.log('clear by tag', timeoutId.current)\n    clearTimeout(timeoutId.current)\n  }, 0)\n  fetchSearchPosts() // ç«‹å³æ‰§è¡Œæœç´¢\n}"]],"language":[["JavaScript"]]},"created_time":1718355269987,"last_edited_time":1718355313706,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"41bfecf6-ed1f-494c-b9b4-53d03856b7f5":{"value":{"id":"41bfecf6-ed1f-494c-b9b4-53d03856b7f5","version":399,"type":"text","properties":{"title":[["åªåœ¨æˆ‘ä»¬ä¸å…³å¿ƒä¾¦å¬"],["searchText",[["c"]]],["çš„ "],["useEffect",[["c"]]],[" å†…å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæˆ‘ä»¬åªå…³å¿ƒå°† "],["timeoutId",[["c"]]],[" æ¢ç”¨ "],["useRef",[["c"]]],[" å­˜å‚¨åä¸ºä»€ä¹ˆå°±èƒ½è§£å†³é—®é¢˜ï¼Ÿ"]]},"created_time":1718355072787,"last_edited_time":1718355419467,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"7f923ba0-3666-4aec-8daa-5dd3d72119d8":{"value":{"id":"7f923ba0-3666-4aec-8daa-5dd3d72119d8","version":660,"type":"text","properties":{"title":[["æ ¹æ®é—­åŒ…æœºåˆ¶ï¼Œ"],["handleTagClick\u003esetTimeout",[["c"]]],[" ä¾æ—§æ•è·äº†è·Ÿ"],["setSearchText(tag)",[["c"]]],[" å¹³çº§çš„"],["timeoutId",[["c"]]],[" ï¼Œè¿™ä¸ªå˜é‡ä¾æ—§æ˜¯ä¸å˜çš„ï¼Œä½†è¿™ä¸ªå˜é‡å®é™…ä¸ŠæŒ‡å‘äº†ä¸€ä¸ª "],["ref",[["c"]]],[" å¯¹è±¡ï¼Œæˆ‘ä»¬é€šè¿‡å…¶"],["current",[["c"]]],[" å±æ€§æ¥è®¿é—®å®ƒçš„å€¼ï¼Œå› è€Œåœ¨"],["useEffect",[["c"]]],[" å†…å‘ç”Ÿçš„æ”¹å˜ï¼Œä¾æ—§ä½œç”¨åˆ°äº†è¿™é‡Œçš„"],["timeoutId",[["c"]]],["ä¸Šï¼ŒæˆåŠŸè®©æˆ‘ä»¬è·å–åˆ°äº†æœ€æ–°çš„"],["timeoutId",[["c"]]],["ï¼"]]},"created_time":1718355366787,"last_edited_time":1718355634031,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"23eba211-5acf-4ec6-b283-c01a23f63a62":{"value":{"id":"23eba211-5acf-4ec6-b283-c01a23f63a62","version":89,"type":"callout","properties":{"title":[["useRef",[["c"]]],[" æ°¸è¿œæ˜¯æœ€æ–°çš„ï¼"]]},"format":{"page_icon":"ğŸ’¡","block_color":"gray_background"},"created_time":1718355636771,"last_edited_time":1718355650626,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"d1268d43-d755-42ae-b58c-b7e73067d85c":{"value":{"id":"d1268d43-d755-42ae-b58c-b7e73067d85c","version":36,"type":"sub_sub_header","properties":{"title":[["è¯·æ±‚é”™è¯¯"]]},"created_time":1718355655597,"last_edited_time":1718356184589,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"3eb53ca3-9ce7-4e26-a76a-7b0b03b43292":{"value":{"id":"3eb53ca3-9ce7-4e26-a76a-7b0b03b43292","version":895,"type":"text","properties":{"title":[["åœ¨æˆåŠŸä¿®å¤äº†å®šæ—¶å™¨æ¸…ç†å¤±æ•ˆçš„é—®é¢˜åï¼Œæˆ‘ä»¬ä¹Ÿå°±åªä¼šå‘é€ä¸€æ¬¡è¯·æ±‚äº†ï¼Œä¹Ÿå°±æ˜¯"],["handleTagClick",[["c"]]],[" ä¸­çš„è¯·æ±‚ï¼Œä½†æ ¹æ®å‰æ–‡æåˆ°çš„é—­åŒ…æœºåˆ¶ï¼Œè¿™é‡Œ"],["fetchSearchPosts()",[["c"]]],[" ä½¿ç”¨çš„ä¾æ—§æ˜¯æ—§çš„å€¼ï¼Œé’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„é€šè¿‡ä¿®æ”¹"],["fetchSearchPosts()",[["c"]]],[" æ¥å®ç°ï¼Œæˆ‘ä»¬è®©å®ƒä¸è¦å†ä¾èµ–å¤–éƒ¨çš„ "],["searchText",[["c"]]],[" æ¥è¿›è¡Œæœç´¢ï¼Œè€Œæ˜¯ä¼ å…¥ä¸€ä¸ªå€¼ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ tag çš„å€¼æ¥è¿›è¡Œæœç´¢ï¼Œä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š"]]},"created_time":1718356185085,"last_edited_time":1718356341412,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"60364b4a-11c1-4f94-9503-d918334568c1":{"value":{"id":"60364b4a-11c1-4f94-9503-d918334568c1","version":19,"type":"code","properties":{"title":[["import { useState, useEffect, useRef } from 'react'\n\nconst useSearchPosts = (initialSearchText = '') =\u003e {\n  const [searchText, setSearchText] = useState(initialSearchText)\n  const [posts, setPosts] = useState([])\n  const timeoutId = useRef(null)\n\n  // è·å–æ‰€æœ‰ prompt\n  const fetchPosts = async () =\u003e {\n    const response = await fetch('/api/prompt')\n    const data = await response.json()\n    setPosts(data)\n  }\n\n  // æ ¹æ®æœç´¢å…³é”®è¯è·å– prompt\n  const fetchSearchPosts = async search =\u003e {\n    const response = await fetch('/api/prompt/search?searchText=' + search)\n    const data = await response.json()\n    setPosts(data)\n  }\n\n  useEffect(() =\u003e {\n    fetchPosts()\n  }, [])\n\n  // é˜²æŠ–\n  useEffect(() =\u003e {\n    if (searchText.trim()) {\n      const newTimeout = setTimeout(() =\u003e {\n        fetchSearchPosts(searchText)\n      }, 1000)\n      timeoutId.current = newTimeout\n      console.log('set!', newTimeout)\n      return () =\u003e clearTimeout(newTimeout)\n    } else {\n      fetchPosts()\n      return () =\u003e clearTimeout(timeoutId.current)\n    }\n  }, [searchText])\n\n  const handleSearchChange = e =\u003e {\n    setSearchText(e.target.value)\n  }\n\n  const handleSubmit = e =\u003e {\n    e.preventDefault()\n    console.log('clear by submit', timeoutId.current)\n    clearTimeout(timeoutId.current)\n    fetchSearchPosts(searchText)\n  }\n\n  const handleTagClick = tag =\u003e {\n    setSearchText(tag)\n    // éœ€è¦ç­‰å¾…searchTextæ›´æ–°å®Œæ¯•ï¼Œå†æ¸…é™¤å‰¯ä½œç”¨å¸¦æ¥çš„å®šæ—¶å™¨\n    setTimeout(() =\u003e {\n      console.log('clear by tag', timeoutId.current)\n      clearTimeout(timeoutId.current)\n    }, 0)\n    fetchSearchPosts(tag) // ç«‹å³æ‰§è¡Œæœç´¢\n  }\n\n  return {\n    searchText,\n    posts,\n    fetchPosts,\n    handleSearchChange,\n    handleSubmit,\n    handleTagClick\n  }\n}\n\nexport default useSearchPosts"]],"language":[["JavaScript"]]},"created_time":1718356341965,"last_edited_time":1718356349252,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"},"632f63b3-9d4f-43ff-8a0c-e2a1cd59cf78":{"value":{"id":"632f63b3-9d4f-43ff-8a0c-e2a1cd59cf78","version":899,"type":"callout","properties":{"title":[["åŸå…ˆçš„"],["fetchSearchPosts",[["c"]]],[" å®Œå…¨ä¾èµ–äº "],["searchText",[["c"]]],[" è¿™ä¸ªå˜é‡ï¼Œä¸èƒ½æ ¹æ®ä¼ å…¥å‚æ•°åŠ¨æ€å†³å®šè¯·æ±‚å‚æ•°ï¼Œè¿™æ ·å†™å¹¶ä¸åˆç†ï¼›å†åŠ ä¸Šæˆ‘ä»¬ç‚¹å‡» tag åï¼Œæˆ‘ä»¬è®¾ç½®"],["searchText",[["c"]]],[" å®Œå…¨æ˜¯ä¸ºäº†è®©æœç´¢æ¡†èƒ½æ˜¾ç¤ºæˆ‘ä»¬ç‚¹å‡»çš„å†…å®¹ï¼Œè€Œå‘é€è¯·æ±‚å°±æ²¡å¿…è¦å†’ç€å˜é‡ä¸æ˜¯æœ€æ–°çš„é£é™©ç”¨"],["searchText",[["c"]]],[" äº†ï¼Œå®Œå…¨å¯ä»¥ç”¨ "],["tag",[["c"]]],[" æ¥å‘é€è¯·æ±‚ã€‚"]]},"format":{"page_icon":"ğŸ’¡","block_color":"gray_background"},"created_time":1718588853123,"last_edited_time":1718589027569,"parent_id":"98540d41-1879-4bea-9bdf-fa17af5cc06e","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"4e783237-cc83-440e-9604-bac369009c55","last_edited_by_table":"notion_user","last_edited_by_id":"4e783237-cc83-440e-9604-bac369009c55","space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"}},"collection":{"4126d965-c550-46af-bc34-c038f0103084":{"value":{"id":"4126d965-c550-46af-bc34-c038f0103084","version":7,"name":[["NOBELIUM Template"]],"schema":{"NX\\Q":{"name":"date","type":"date","description":""},"`gQ~":{"name":"type","type":"select","options":[{"id":"5aff2f95-fd1e-489b-8840-bf10bc9519cb","color":"purple","value":"Post"},{"id":"374d2bc6-a144-4832-8ca4-474aaae0ea1f","color":"orange","value":"Page"}]},"d]hq":{"name":"slug","type":"text"},"sD^m":{"name":"tags","type":"multi_select","options":[{"id":"b67fb051-ddd9-43b5-9fdf-7b7f97a2e056","color":"yellow","value":"Jekyll"},{"id":"2382b30f-9881-4a8b-ae7f-2d34979c4fb9","color":"pink","value":"Website"},{"id":"674b2636-c585-4057-8a6d-0d6ab9718f90","color":"blue","value":"Cooking"},{"id":"499d31ac-26f2-4fed-9ec4-17afe3c6d90d","color":"red","value":"Sociology"},{"id":"38611f8e-ab81-4a71-8d40-7bad1370b26a","color":"orange","value":"TEMP"},{"id":"1ad9233c-079a-44c7-98c3-24ed2faf1879","color":"purple","value":"Book"},{"id":"a3d8eb51-77ce-4e83-a9ae-68da9cee63fa","color":"default","value":"Design"},{"id":"87df7c95-06f0-477a-a530-14be415a1dcf","color":"gray","value":"React"},{"id":"76cb8fea-49e8-47c1-a982-b3a8a23d2278","color":"green","value":"Next.js"},{"id":"63e95905-41f5-4027-8bd4-330129476432","color":"brown","value":"TODO"},{"id":"6dbab06e-0532-484d-9c94-9be429b2abf8","color":"red","value":"Nobelium"},{"id":"a7dda041-f452-423c-b00f-dbe7402400ca","color":"pink","value":"JavaScript"}]},"wz|S":{"name":"summary","type":"text"},"title":{"name":"title","type":"title"},"f211bdc0-ee00-4186-9a7d-f68c055ec2ee":{"name":"status","type":"select","options":[{"id":"22460321-fea2-4c7c-b352-a674760780ac","color":"orange","value":"Idea"},{"id":"41d5f5c6-b53c-42bc-8e0f-fc9402048480","color":"yellow","value":"Draft"},{"id":"c7390b31-9fab-4e21-94ee-7e67ea077a97","color":"blue","value":"Revise"},{"id":"7abc61d4-b405-480d-b699-12588755fa65","color":"red","value":"Published"}]}},"icon":"ğŸŸï¸","format":{"copied_from_pointer":{"id":"47ddddc3-991e-4ade-a7a4-a99e37f4d3ff","table":"collection","spaceId":"b3580129-1025-4b78-9e73-0a6f39f464ab"},"collection_page_properties":[{"visible":false,"property":"NX\\Q"},{"visible":false,"property":"d]hq"},{"visible":false,"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"visible":false,"property":"sD^m"},{"visible":false,"property":"wz|S"},{"visible":false,"property":"`gQ~"}]},"parent_id":"0eb813c6-179c-43e0-8c12-27cc22341e33","parent_table":"block","alive":true,"file_ids":["6cf3dc36-2f98-4f0e-9679-1bdbb1485129","5520bd92-e709-4c0d-ad58-06923f23f7e9","624d393a-62e3-4464-a1bf-1c79ecd4fbda","d52f6766-3e32-4c3d-8529-46e1f214360f"],"copied_from":"47ddddc3-991e-4ade-a7a4-a99e37f4d3ff","migrated":true,"space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"}},"space":{},"collection_view":{"1df80a31-46e8-4fcd-b9a3-dde8ded944c9":{"value":{"id":"1df80a31-46e8-4fcd-b9a3-dde8ded944c9","version":11,"type":"table","name":"Default view","format":{"table_wrap":false,"table_properties":[{"width":416,"visible":true,"property":"title"},{"width":186,"visible":true,"property":"d]hq"},{"width":145,"visible":true,"property":"NX\\Q"},{"width":147,"visible":true,"property":"wz|S"},{"width":222,"visible":true,"property":"sD^m"},{"width":124,"visible":true,"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"width":100,"visible":true,"property":"`gQ~"}],"table_frozen_column_index":-1},"parent_id":"0eb813c6-179c-43e0-8c12-27cc22341e33","parent_table":"block","alive":true,"page_sort":["b1e1d645-db95-42e5-8995-39a80eda6460","e8cd3732-dc1c-43ae-959a-a5a611ec098a","e876558d-e878-47f6-8c95-21be678990a5","5a971ded-d3c5-41be-bef9-ddfff48d43a2","8db8b240-e1c5-4dd7-bf74-72584d7a2ce0","daf94ca4-ec56-47a3-84ed-b1e2479acc4b","d1a2db9b-6820-421e-9b80-017ce7478587","67ea9f83-b9f6-416b-afcb-7c64f7533e6c","45939470-9819-47e8-b12b-999cfefa0aad","c60dc33d-8efb-44be-a863-7a87ad047932","fe4b8d5f-7c49-42c6-a7d5-1cb71c4f7e86","b7233a67-c367-4198-831e-f12089568d1f","4f3bf306-92c4-41b7-a43e-957129a1240a","6a789607-66cf-498e-9b32-eb3fa69a84f4","c9429034-dabd-4a25-8782-97f20c808a60","38c49fe2-37f8-4a7f-a99f-9edb9ddad4c2","474eb638-9f6b-46bf-8004-77668293f199","81d6dfab-69cb-43a0-aa04-e9725f0b67e1","7703d956-84db-46cd-b538-48eae1af68b5","9f937c73-dac9-4ed7-9b01-beefcb321f16","3cf9dcb9-e7db-406c-80ab-c65c11fbf906","5827ab53-e051-455b-b90a-3bdc20158c2c","fa7acd3b-dea9-4fb1-b859-5345f35163c6","696dfc48-62c3-494d-96d0-ec5fa84637e8","79df93cf-9b10-452e-bc62-f39e8cd2d124","9bb8e52d-c459-4528-b1b3-c2378207253a","5da038ef-f419-4a11-aa48-587b3787e040","b4a2c9d4-6a2c-49e6-988d-89a538dfe0f6","c374a479-5cc7-4c54-ba69-6a4d76dc25ad","d470fa67-0e7c-40d8-86ac-9b5a8be88dc8","986be38b-9780-4bb9-bdcd-4e361ddbd888","b7613f56-c2d4-4aae-b967-b7471ade86d0","e357d1fc-7466-4d6a-8d48-71b76ea97cdc","e1735855-4089-4af6-bd4d-0d59f7a76cb4","9b34581a-955a-4229-99d0-8f2a6d0e69ce","b4414811-0599-45cf-b047-fa95eac42d89","c28a8a01-911a-40a2-a607-d3af8cb24017","461d07ae-4b4a-49de-bdcb-341af1153201","3df59023-cb68-4a65-afd1-7f0b8c21cb57","0e3223d1-03df-40fb-90f9-cc8559d776b5","4f45b7d6-cd5b-46ab-b2a6-37ae20bf5f21","fa475a21-5f38-43d4-9a89-67c40b3129ae","97cbc634-fe3a-4b9b-9da6-ac4aaa94772f","8a0d34bc-7e8c-4a68-88a5-5276274f612a","623f8788-a20f-45fd-bb82-08935f59b44d","7ee398f0-450b-47cb-9b53-f5e7736590d2","eae9f077-591e-4841-903b-db395513c834","367d0f2a-0b10-4dbb-b53a-613152f124f9","398e2e28-3997-49bc-a138-0467d4da8531","8aaf4633-e879-44dc-82c8-3c9fb9d3a6f8","1eb5e5f2-8dc9-4ffc-b5e1-09b67be27a83","83465fb9-205b-41fc-83a6-424692ee0a0e","fb1d18d0-6403-4e8a-840e-134553748ff5","4407cb77-3838-4ba5-b474-f15222cd3dba","1880b0f2-e036-42d0-9550-0fb08a962397","d8d60bd6-33f6-458f-a7d6-209ef2fb05a1","29bf65ff-888b-4a76-a8dd-bf54f02c3864","bad1d4ae-fd4a-4671-ae94-dd53d94e0eae","0d59792d-db1c-4ae7-8d7c-4f013be40dcf","337dc259-2805-4b1c-a60f-1b3e6c7badb8","4b1b21a8-c278-4bc6-88f1-1a35d407f4d7","7946aba2-d6d0-45ef-8779-23fa15db8f2d","c18dbce6-9e8c-4f4b-b74a-0994e7c1bc3f","84aa87b7-39e7-493c-87b9-5cae4de95449","1446eadb-8c01-4295-be3a-ecf19361c143","fe8a7d94-e9ba-457d-8f19-10fe53e6ca3c","98a5a0b6-b07b-4065-a73f-2949ad28ac47","6efcebe0-a779-4ec2-a1cb-f77acbb36bf6","c62e81a1-03a9-4b5c-9a55-4e56867de3e4","5514a197-e266-4487-a3ce-95ae17f26bdb","51f3b1a2-a3d5-468a-b552-70d7b0c1a9cb","baacb561-6a62-4343-9e6a-bc1bba469a9c","9ca0671d-b580-4105-825c-d8ef4c531d84","d11cc5a5-b975-4a3a-9d78-739e3680b3fa","98540d41-1879-4bea-9bdf-fa17af5cc06e","f24edd31-035d-4744-9275-118e8751f2f9","975051d4-ebbc-4b3f-98cf-1a52e5e4761d","e5d98bee-b2d5-4b45-ab0b-b77da24aebe7","acac2668-1062-4e7a-b095-eda067da8413","179025c4-d8a8-4c47-b621-9fd6a6f3339b","d256e5ed-5eac-43bb-a32e-581774962c23","59520f7f-1fe9-4c70-b059-8655b93e85df","5692c8b3-efa6-4f19-ab2e-4574afc33f46","9c40a253-b9e8-42cd-8a99-62aaa9789a5e","fd348e41-3e72-42d2-8425-be67e8586a28","3128120c-366d-4937-a28a-f18a446f249b","a1d00689-b6f7-418b-888e-0b47edc21286","090eeb36-6c03-462f-9ada-d544c584641f","e97e229c-7a7c-4ce6-81f7-2cf8700e22ab","926771d9-3aab-4640-8dec-b1202f54aa69","b9a5c48f-1b00-4ae9-94bc-f683d6b393ad","30602d25-a696-40ee-b0fa-c252403391cf","a5da67e2-2ac7-4c3a-8833-50d78f853f9b","cf2532d2-7c86-4027-ae70-a81784ff4769","c1e63240-b7fe-4e0e-b753-78a9210b7779","81581b92-d191-4010-8c4f-e2c0e0b4a4ee","69e2cb5f-2c4a-408a-95b5-9d03f8ccfab3","b5b9b1d9-377b-4053-b110-988a9ec54af7","9a223272-0900-4cc3-a503-2515824da515","7c88ce0f-c4be-4335-abfe-adaaa2c6c99e","79bf7035-9dfd-4193-b7d1-cd578a30ac85","a453aa9d-324d-448f-94f0-c8adb4692241","1030c439-2997-45a7-90ca-f2df5de62e3e","1235234b-cfee-4611-8a9b-c6b32b379585","710ff2f6-c05e-4403-b72a-512bb27ab51f","019d0c55-59ee-4247-90c8-5f9017c37ba5","d105e4c2-dfdb-4c58-b8f5-54e182894431","95585600-97d8-4d2c-bf0c-6b9164dbee54","51e53e64-e6dd-4fd6-8062-5d4455f0a1cb","f4ec684b-e5f1-44e9-a8a7-aca27f7ca6f3","177fa228-9099-4dd5-8969-c67f9c78bd0c","d5ab0d7a-0123-473f-84d4-81740defb9b4","548f6d36-c509-4b79-9c4b-59f227c7f550","c0901673-4f5e-4e51-ad87-0217f2d33a0c","0787f8d6-dc99-47c6-946e-2b008814bebc","0ade5216-1103-486a-aff0-a709ff825b02","a2c4dd21-985c-497d-b421-c2d8a9ec0eeb","908a498c-f7e3-4668-8afd-f179a027b4d9","4945e5c3-033d-467c-a8b3-b1479c1fdf0a","854f4584-28d5-43bd-938e-88d0957c78e3","6a6574f8-d63d-4fed-99c5-38f3df0364ac"],"query2":{"filter":{"operator":"and"},"aggregations":[{"property":"title","aggregator":"count"}]},"space_id":"01ff42de-5b53-40d7-a69e-999e3574e640"},"role":"reader"}},"notion_user":{},"collection_query":{},"signed_urls":{}},"emailHash":"568c024e516219d57a6ef037a7cc3d32"},"__N_SSG":true},"page":"/[slug]","query":{"slug":"Promptopia-dev-note-state-ref-and-async"},"buildId":"pLVj_ZB4irF9cq-SHm4_w","assetPrefix":"/nobelium","runtimeConfig":{"basePath":"/nobelium","assetPrefix":"/nobelium/"},"isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>